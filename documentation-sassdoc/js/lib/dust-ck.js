//
// Dust - Asynchronous Templating v0.3.0
// http://akdubya.github.com/dustjs
//
// Copyright (c) 2010, Aleksander Williams
// Released under the MIT License.
//
var dust={};(function(o){function z(e,t,n){this.stack=e;this.global=t;this.blocks=n}function H(e,t,n,r){this.tail=t;this.isObject=!o.isArray(e)&&e&&typeof e=="object";this.head=e;this.index=n;this.of=r}function p(e){this.head=new B(this);this.callback=e;this.out=""}function J(){this.head=new B(this)}function B(e,t,n){this.root=e;this.next=t;this.data="";this.flushable=!1;this.taps=n}function r(e,t){this.head=e;this.tail=t}o.cache={};o.register=function(e,t){e&&(o.cache[e]=t)};o.render=function(e,t,n){n=(new p(n)).head;o.load(e,n,z.wrap(t)).end()};o.stream=function(e,t){var n=new J;o.nextTick(function(){o.load(e,n.head,z.wrap(t)).end()});return n};o.renderSource=function(e,t,n){return o.compileFn(e)(t,n)};o.compileFn=function(e,t){var n=o.loadSource(o.compile(e,t));return function(e,t){var r=t?new p(t):new J;o.nextTick(function(){n(r.head,z.wrap(e)).end()});return r}};o.load=function(e,t,n){var r=o.cache[e];return r?r(t,n):o.onLoad?t.map(function(t){o.onLoad(e,function(r,i){if(r)return t.setError(r);o.cache[e]||o.loadSource(o.compile(i,e));o.cache[e](t,n).end()})}):t.setError(Error("Template Not Found: "+e))};o.loadSource=function(e){return eval(e)};o.isArray=Array.isArray?Array.isArray:function(e){return Object.prototype.toString.call(e)=="[object Array]"};o.nextTick=function(e){setTimeout(e,0)};o.isEmpty=function(e){return o.isArray(e)&&!e.length?!0:e===0?!1:!e};o.filter=function(e,t,n){if(n)for(var r=0,i=n.length;r<i;r++){var s=n[r];s==="s"?t=null:e=o.filters[s](e)}t&&(e=o.filters[t](e));return e};o.filters={h:function(e){return o.escapeHtml(e)},j:function(e){return o.escapeJs(e)},u:encodeURI,uc:encodeURIComponent};o.makeBase=function(e){return new z(new H,e)};z.wrap=function(e){return e instanceof z?e:new z(new H(e))};z.prototype.get=function(e){for(var t=this.stack,n;t;){if(t.isObject){n=t.head[e];if(n!==undefined)return n}t=t.tail}return this.global?this.global[e]:undefined};z.prototype.getPath=function(e,t){var n=this.stack,r=t.length;if(e&&r===0)return n.head;if(n.isObject){n=n.head;for(var i=0;n&&i<r;){n=n[t[i]];i++}return n}};z.prototype.push=function(e,t,n){return new z(new H(e,this.stack,t,n),this.global,this.blocks)};z.prototype.rebase=function(e){return new z(new H(e),this.global,this.blocks)};z.prototype.current=function(){return this.stack.head};z.prototype.getBlock=function(e){var t=this.blocks;if(t)for(var n=t.length,r;n--;)if(r=t[n][e])return r};z.prototype.shiftBlocks=function(e){var t=this.blocks;if(e){newBlocks=t?t.concat([e]):[e];return new z(this.stack,this.global,newBlocks)}return this};p.prototype.flush=function(){for(var e=this.head;e;){if(!e.flushable){if(e.error){this.callback(e.error);this.flush=function(){}}return}this.out+=e.data;this.head=e=e.next}this.callback(null,this.out)};J.prototype.flush=function(){for(var e=this.head;e;){if(!e.flushable){if(e.error){this.emit("error",e.error);this.flush=function(){}}return}this.emit("data",e.data);this.head=e=e.next}this.emit("end")};J.prototype.emit=function(e,t){var n=this.events;n&&n[e]&&n[e](t)};J.prototype.on=function(e,t){this.events||(this.events={});this.events[e]=t;return this};B.prototype.write=function(e){var t=this.taps;t&&(e=t.go(e));this.data+=e;return this};B.prototype.end=function(e){e&&this.write(e);this.flushable=!0;this.root.flush();return this};B.prototype.map=function(e){var t=new B(this.root,this.next,this.taps),n=new B(this.root,t,this.taps);this.next=n;this.flushable=!0;e(n);return t};B.prototype.tap=function(e){var t=this.taps;this.taps=t?t.push(e):new r(e);return this};B.prototype.untap=function(){this.taps=this.taps.tail;return this};B.prototype.render=function(e,t){return e(this,t)};B.prototype.reference=function(e,t,n,r){if(typeof e=="function"){e=e(this,t,null,{auto:n,filters:r});if(e instanceof B)return e}return o.isEmpty(e)?this:this.write(o.filter(e,n,r))};B.prototype.section=function(e,t,n,r){if(typeof e=="function"){e=e(this,t,n,r);if(e instanceof B)return e}var i=n.block;n=n["else"];r&&(t=t.push(r));if(o.isArray(e)){if(i){r=e.length;n=this;for(var s=0;s<r;s++)n=i(n,t.push(e[s],s,r));return n}}else if(e===!0){if(i)return i(this,t)}else if(e||e===0){if(i)return i(this,t.push(e))}else if(n)return n(this,t);return this};B.prototype.exists=function(e,t,n){var r=n.block;n=n["else"];if(o.isEmpty(e)){if(n)return n(this,t)}else if(r)return r(this,t);return this};B.prototype.notexists=function(e,t,n){var r=n.block;n=n["else"];if(o.isEmpty(e)){if(r)return r(this,t)}else if(n)return n(this,t);return this};B.prototype.block=function(e,t,n){n=n.block;e&&(n=e);return n?n(this,t):this};B.prototype.partial=function(e,t){return typeof e=="function"?this.capture(e,t,function(e,n){o.load(e,n,t).end()}):o.load(e,this,t)};B.prototype.helper=function(e,t,n,r){return o.helpers[e](this,t,n,r)};B.prototype.capture=function(e,t,n){return this.map(function(r){var i=new p(function(e,t){e?r.setError(e):n(t,r)});e(i.head,t).end()})};B.prototype.setError=function(e){this.error=e;this.root.flush();return this};o.helpers={sep:function(e,t,n){return t.stack.index===t.stack.of-1?e:n.block(e,t)},idx:function(e,t,n){return n.block(e,t.push(t.stack.index))}};r.prototype.push=function(e){return new r(e,this)};r.prototype.go=function(e){for(var t=this;t;){e=t.head(e);t=t.tail}return e};var K=RegExp(/[&<>\"]/),q=/&/g,j=/</g,w=/>/g,t=/\"/g;o.escapeHtml=function(e){return typeof e=="string"?K.test(e)?e.replace(q,"&amp;").replace(j,"&lt;").replace(w,"&gt;").replace(t,"&quot;"):e:e};var y=/\\/g,A=/\r/g,F=/\u2028/g,L=/\u2029/g,N=/\n/g,V=/\f/g,I=/'/g,Q=/"/g,T=/\t/g;o.escapeJs=function(e){return typeof e=="string"?e.replace(y,"\\\\").replace(Q,'\\"').replace(I,"\\'").replace(A,"\\r").replace(F,"\\u2028").replace(L,"\\u2029").replace(N,"\\n").replace(V,"\\f").replace(T,"\\t"):e}})(dust);if(typeof exports!="undefined"){typeof process!="undefined"&&require("./server")(dust);module.exports=dust}(function(e){function t(t,n){for(var r=[n[0]],i=1,s=n.length;i<s;i++){var o=e.filterNode(t,n[i]);o&&r.push(o)}return r}function n(e,t){return t}function r(){}function i(t,n){for(var r="",i=1,s=n.length;i<s;i++)r+=e.compileNode(t,n[i]);return r}function s(t,n,r){return"."+r+"("+e.compileNode(t,n[1])+","+e.compileNode(t,n[2])+","+e.compileNode(t,n[4])+","+e.compileNode(t,n[3])+")"}e.compile=function(t,n){var r,i=e.parse(t);r=e.filterNode({},i);i={name:n,bodies:[],blocks:{},index:0,auto:"h"};r="(function(){dust.register("+(n?'"'+n+'"':"null")+","+e.compileNode(i,r)+");";var s,o=[],u=i.blocks;for(s in u)o.push(s+":"+u[s]);if(o.length){i.blocks="ctx=ctx.shiftBlocks(blocks);";s="var blocks={"+o.join(",")+"};"}else s=i.blocks="";s=r+s;r=[];o=i.bodies;i=i.blocks;u=0;for(var a=o.length;u<a;u++)r[u]="function body_"+u+"(chk,ctx){"+i+"return chk"+o[u]+";}";i=r.join("");return s+i+"return body_0;})();"};e.filterNode=function(t,n){return e.optimizers[n[0]](t,n)};e.optimizers={body:function(t,n){for(var r=[n[0]],i,s=1,o=n.length;s<o;s++){var u=e.filterNode(t,n[s]);if(u)if(u[0]==="buffer")if(i)i[1]+=u[1];else{i=u;r.push(u)}else{i=null;r.push(u)}}return r},buffer:n,special:function(e,t){return["buffer",o[t[1]]]},format:r,reference:t,"#":t,"?":t,"^":t,"<":t,"+":t,"@":t,"%":t,partial:t,context:t,params:t,bodies:t,param:t,filters:n,key:n,path:n,literal:n,comment:r};e.pragmas={esc:function(e,t,n){var r=e.auto;t||(t="h");e.auto=t==="s"?"":t;t=i(e,n.block);e.auto=r;return t}};var o={s:" ",n:"\n",r:"\r",lb:"{",rb:"}"};e.compileNode=function(t,n){return e.nodes[n[0]](t,n)};e.nodes={body:function(e,t){var n=e.index++,r="body_"+n;e.bodies[n]=i(e,t);return r},buffer:function(e,t){return".write("+u(t[1])+")"},format:function(e,t){return".write("+u(t[1]+t[2])+")"},reference:function(t,n){return".reference("+e.compileNode(t,n[1])+",ctx,"+e.compileNode(t,n[2])+")"},"#":function(e,t){return s(e,t,"section")},"?":function(e,t){return s(e,t,"exists")},"^":function(e,t){return s(e,t,"notexists")},"<":function(t,n){for(var r=n[4],i=1,s=r.length;i<s;i++){var o=r[i];if(o[1][1]==="block"){t.blocks[n[1].text]=e.compileNode(t,o[2]);break}}return""},"+":function(t,n){return".block(ctx.getBlock("+u(n[1].text)+"),"+e.compileNode(t,n[2])+","+e.compileNode(t,n[4])+","+e.compileNode(t,n[3])+")"},"@":function(t,n){return".helper("+u(n[1].text)+","+e.compileNode(t,n[2])+","+e.compileNode(t,n[4])+","+e.compileNode(t,n[3])+")"},"%":function(t,n){var r=n[1][1];if(!e.pragmas[r])return"";for(var i=n[4],s={},o=1,u=i.length;o<u;o++){var a=i[o];s[a[1][1]]=a[2]}i=n[3];a={};o=1;for(u=i.length;o<u;o++){var f=i[o];a[f[1][1]]=f[2][1]}return e.pragmas[r](t,n[2][1]?n[2][1].text:null,s,a)},partial:function(t,n){return".partial("+e.compileNode(t,n[1])+","+e.compileNode(t,n[2])+")"},context:function(t,n){return n[1]?"ctx.rebase("+e.compileNode(t,n[1])+")":"ctx"},params:function(t,n){for(var r=[],i=1,s=n.length;i<s;i++)r.push(e.compileNode(t,n[i]));return r.length?"{"+r.join(",")+"}":"null"},bodies:function(t,n){for(var r=[],i=1,s=n.length;i<s;i++)r.push(e.compileNode(t,n[i]));return"{"+r.join(",")+"}"},param:function(t,n){return e.compileNode(t,n[1])+":"+e.compileNode(t,n[2])},filters:function(e,t){for(var n=[],r=1,i=t.length;r<i;r++)n.push('"'+t[r]+'"');return'"'+e.auto+'"'+(n.length?",["+n.join(",")+"]":"")},key:function(e,t){return'ctx.get("'+t[1]+'")'},path:function(e,t){for(var n=t[1],r=t[2],i=[],s=0,o=r.length;s<o;s++)i.push('"'+r[s]+'"');return"ctx.getPath("+n+",["+i.join(",")+"])"},literal:function(e,t){return u(t[1])}};var u=typeof JSON=="undefined"?function(t){return'"'+e.escapeJs(t)+'"'}:JSON.stringify})(typeof exports!="undefined"?exports:window.dust);(function(e){var t=function(){var e={parse:function(e){function t(e){var t=e.charCodeAt(0);if(t<255){e="x";var n=2}else{e="u";n=4}e="\\"+e;var r=t.toString(16).toUpperCase();t=r;n-=r.length;for(r=0;r<n;r++)t="0"+t;return e+t}function n(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,t)+'"'}function r(e){if(!(A<M)){if(A>M){M=A;_=[]}_.push(e)}}function i(){var e="body@"+A,t=D[e];if(t){A=t.nextPos;return t.result}t=[];for(var n=s();n!==null;){t.push(n);n=s()}t=t!==null?["body"].concat(t):null;D[e]={nextPos:A,result:t};return t}function s(){var t="part@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=w();if(n!==null)n=n;else{n=o();if(n!==null)n=n;else{n="partial@"+A;var i=D[n];if(i){A=i.nextPos;n=i.result}else{i=O;O=!1;var s=A,u=S();if(u!==null){if(e.substr(A,1)===">"){var a=">";A+=1}else{a=null;O&&r('">"')}if(a!==null){var l=v();l=l!==null?["literal",l]:null;if(l!==null)l=l;else{l=m();l=l!==null?l:null}if(l!==null){var p=f();if(p!==null){if(e.substr(A,1)==="/"){var d="/";A+=1}else{d=null;O&&r('"/"')}if(d!==null){var g=x();if(g!==null)u=[u,a,l,p,d,g];else{u=null;A=s}}else{u=null;A=s}}else{u=null;A=s}}else{u=null;A=s}}else{u=null;A=s}}else{u=null;A=s}s=u!==null?["partial",u[2],u[3]]:null;(O=i)&&s===null&&r("partial");D[n]={nextPos:A,result:s};n=s}if(n!==null)n=n;else{n=h();if(n!==null)n=n;else{n=c();if(n!==null)n=n;else{n="buffer@"+A;if(i=D[n]){A=i.nextPos;n=i.result}else{i=O;O=!1;s=A;u=T();if(u!==null){a=[];for(l=N();l!==null;){a.push(l);l=N()}if(a!==null)u=[u,a];else{u=null;A=s}}else{u=null;A=s}s=u!==null?["format",u[0],u[1].join("")]:null;if(s!==null)s=s;else{l=u=A;a=O;O=!1;p=E();O=a;if(p===null)a="";else{a=null;A=l}if(a!==null){p=A;l=O;O=!1;d=T();O=l;if(d===null)l="";else{l=null;A=p}if(l!==null){p=A;d=O;O=!1;g=w();O=d;if(g===null)d="";else{d=null;A=p}if(d!==null){if(e.length>A){p=e.charAt(A);A++}else{p=null;O&&r("any character")}if(p!==null)a=[a,l,d,p];else{a=null;A=u}}else{a=null;A=u}}else{a=null;A=u}}else{a=null;A=u}u=a!==null?a[3]:null;if(u!==null)for(s=[];u!==null;){s.push(u);l=u=A;a=O;O=!1;p=E();O=a;if(p===null)a="";else{a=null;A=l}if(a!==null){p=A;l=O;O=!1;d=T();O=l;if(d===null)l="";else{l=null;A=p}if(l!==null){p=A;d=O;O=!1;g=w();O=d;if(g===null)d="";else{d=null;A=p}if(d!==null){if(e.length>A){p=e.charAt(A);A++}else{p=null;O&&r("any character")}if(p!==null)a=[a,l,d,p];else{a=null;A=u}}else{a=null;A=u}}else{a=null;A=u}}else{a=null;A=u}u=a!==null?a[3]:null}else s=null;s=s!==null?["buffer",s.join("")]:null;s=s!==null?s:null}(O=i)&&s===null&&r("buffer");D[n]={nextPos:A,result:s};n=s}n=n!==null?n:null}}}}}D[t]={nextPos:A,result:n};return n}function o(){var t="section@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=O;O=!1;var s=A,o=u();if(o!==null){var f=x();if(f!==null){var c=i();if(c!==null){var h=l();if(h!==null){var p=a();if(p!==null){var d=o[1].text===p.text?"":null;if(d!==null)o=[o,f,c,h,p,d];else{o=null;A=s}}else{o=null;A=s}}else{o=null;A=s}}else{o=null;A=s}}else{o=null;A=s}}else{o=null;A=s}s=o!==null?function(e,t,n){n.push(["param",["literal","block"],t]);e.push(n);return e}(o[0],o[2],o[3],o[4]):null;if(s!==null)s=s;else{s=A;o=u();if(o!==null){if(e.substr(A,1)==="/"){f="/";A+=1}else{f=null;O&&r('"/"')}if(f!==null){c=x();if(c!==null)o=[o,f,c];else{o=null;A=s}}else{o=null;A=s}}else{o=null;A=s}s=o!==null?function(e){e.push(["bodies"]);return e}(o[0]):null;s=s!==null?s:null}(O=n)&&s===null&&r("section");D[t]={nextPos:A,result:s};return s}function u(){var t="sec_tag_start@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=A;var i=S();if(i!==null){if(e.substr(A).match(/^[#?^<+@%]/)!==null){var s=e.charAt(A);A++}else{s=null;O&&r("[#?^<+@%]")}if(s!==null){var o=p();if(o!==null){var u=f();if(u!==null){var a;a="params@"+A;var l=D[a];if(l){A=l.nextPos;a=l.result}else{l=O;O=!1;var c=[],h=A,d=N();if(d!==null){var g=v();if(g!==null){if(e.substr(A,1)==="="){var y="=";A+=1}else{y=null;O&&r('"="')}if(y!==null){var b=p();if(b!==null)b=b;else{b=m();b=b!==null?b:null}if(b!==null)d=[d,g,y,b];else{d=null;A=h}}else{d=null;A=h}}else{d=null;A=h}}else{d=null;A=h}for(h=d!==null?["param",["literal",d[1]],d[3]]:null;h!==null;){c.push(h);h=A;d=N();if(d!==null){g=v();if(g!==null){if(e.substr(A,1)==="="){y="=";A+=1}else{y=null;O&&r('"="')}if(y!==null){b=p();if(b!==null)b=b;else{b=m();b=b!==null?b:null}if(b!==null)d=[d,g,y,b];else{d=null;A=h}}else{d=null;A=h}}else{d=null;A=h}}else{d=null;A=h}h=d!==null?["param",["literal",d[1]],d[3]]:null}c=c!==null?["params"].concat(c):null;(O=l)&&c===null&&r("params");D[a]={nextPos:A,result:c};a=c}if(a!==null)i=[i,s,o,u,a];else{i=null;A=n}}else{i=null;A=n}}else{i=null;A=n}}else{i=null;A=n}}else{i=null;A=n}n=i!==null?[i[1],i[2],i[3],i[4]]:null;D[t]={nextPos:A,result:n};return n}function a(){var t="end_tag@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=O;O=!1;var i=A,s=S();if(s!==null){if(e.substr(A,1)==="/"){var o="/";A+=1}else{o=null;O&&r('"/"')}if(o!==null){var u=p();if(u!==null){var a=x();if(a!==null)s=[s,o,u,a];else{s=null;A=i}}else{s=null;A=i}}else{s=null;A=i}}else{s=null;A=i}i=s!==null?s[2]:null;(O=n)&&i===null&&r("end tag");D[t]={nextPos:A,result:i};return i}function f(){var t="context@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=A;if(e.substr(A,1)===":"){var i=":";A+=1}else{i=null;O&&r('":"')}if(i!==null){var s=p();if(s!==null)i=[i,s];else{i=null;A=n}}else{i=null;A=n}n=i!==null?i[1]:null;n=n!==null?n:"";n=n!==null?n?["context",n]:["context"]:null;D[t]={nextPos:A,result:n};return n}function l(){var t="bodies@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=O;O=!1;var s=[],o=A,u=S();if(u!==null){if(e.substr(A,1)===":"){var a=":";A+=1}else{a=null;O&&r('":"')}if(a!==null){var f=v();if(f!==null){var l=x();if(l!==null){var c=i();if(c!==null)u=[u,a,f,l,c];else{u=null;A=o}}else{u=null;A=o}}else{u=null;A=o}}else{u=null;A=o}}else{u=null;A=o}for(o=u!==null?["param",["literal",u[2]],u[4]]:null;o!==null;){s.push(o);o=A;u=S();if(u!==null){if(e.substr(A,1)===":"){a=":";A+=1}else{a=null;O&&r('":"')}if(a!==null){f=v();if(f!==null){l=x();if(l!==null){c=i();if(c!==null)u=[u,a,f,l,c];else{u=null;A=o}}else{u=null;A=o}}else{u=null;A=o}}else{u=null;A=o}}else{u=null;A=o}o=u!==null?["param",["literal",u[2]],u[4]]:null}s=s!==null?["bodies"].concat(s):null;(O=n)&&s===null&&r("bodies");D[t]={nextPos:A,result:s};return s}function c(){var t="reference@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=O;O=!1;var i=A,s=S();if(s!==null){var o=p();if(o!==null){var u;u="filters@"+A;var a=D[u];if(a){A=a.nextPos;u=a.result}else{a=O;O=!1;var f=[],l=A;if(e.substr(A,1)==="|"){var c="|";A+=1}else{c=null;O&&r('"|"')}if(c!==null){var h=v();if(h!==null)c=[c,h];else{c=null;A=l}}else{c=null;A=l}for(l=c!==null?c[1]:null;l!==null;){f.push(l);l=A;if(e.substr(A,1)==="|"){c="|";A+=1}else{c=null;O&&r('"|"')}if(c!==null){h=v();if(h!==null)c=[c,h];else{c=null;A=l}}else{c=null;A=l}l=c!==null?c[1]:null}f=f!==null?["filters"].concat(f):null;(O=a)&&f===null&&r("filters");D[u]={nextPos:A,result:f};u=f}if(u!==null){a=x();if(a!==null)s=[s,o,u,a];else{s=null;A=i}}else{s=null;A=i}}else{s=null;A=i}}else{s=null;A=i}i=s!==null?["reference",s[1],s[2]]:null;(O=n)&&i===null&&r("reference");D[t]={nextPos:A,result:i};return i}function h(){var t="special@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=O;O=!1;var i=A,s=S();if(s!==null){if(e.substr(A,1)==="~"){var o="~";A+=1}else{o=null;O&&r('"~"')}if(o!==null){var u=v();if(u!==null){var a=x();if(a!==null)s=[s,o,u,a];else{s=null;A=i}}else{s=null;A=i}}else{s=null;A=i}}else{s=null;A=i}i=s!==null?["special",s[2]]:null;(O=n)&&i===null&&r("special");D[t]={nextPos:A,result:i};return i}function p(){var e="identifier@"+A,t=D[e];if(t){A=t.nextPos;return t.result}t=O;O=!1;var n=d();n=n!==null?L(["path"].concat(n),e):null;if(n!==null)n=n;else{n=v();n=n!==null?L(["key",n],e):null;n=n!==null?n:null}(O=t)&&n===null&&r("identifier");D[e]={nextPos:A,result:n};return n}function d(){var t="path@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=O;O=!1;var i=A,s=v();s=s!==null?s:"";if(s!==null){var o=A;if(e.substr(A,1)==="."){var u=".";A+=1}else{u=null;O&&r('"."')}if(u!==null){var a=v();if(a!==null)u=[u,a];else{u=null;A=o}}else{u=null;A=o}o=u!==null?u[1]:null;if(o!==null)for(var f=[];o!==null;){f.push(o);o=A;if(e.substr(A,1)==="."){u=".";A+=1}else{u=null;O&&r('"."')}if(u!==null){a=v();if(a!==null)u=[u,a];else{u=null;A=o}}else{u=null;A=o}o=u!==null?u[1]:null}else f=null;if(f!==null)s=[s,f];else{s=null;A=i}}else{s=null;A=i}i=s!==null?function(e,t){if(e){t.unshift(e);return[!1,t]}return[!0,t]}(s[0],s[1]):null;if(i!==null)i=i;else{if(e.substr(A,1)==="."){i=".";A+=1}else{i=null;O&&r('"."')}i=i!==null?[!0,[]]:null;i=i!==null?i:null}(O=n)&&i===null&&r("path");D[t]={nextPos:A,result:i};return i}function v(){var t="key@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=O;O=!1;var i=A;if(e.substr(A).match(/^[a-zA-Z_$]/)!==null){var s=e.charAt(A);A++}else{s=null;O&&r("[a-zA-Z_$]")}if(s!==null){var o=[];if(e.substr(A).match(/^[0-9a-zA-Z_$]/)!==null){var u=e.charAt(A);A++}else{u=null;O&&r("[0-9a-zA-Z_$]")}for(;u!==null;){o.push(u);if(e.substr(A).match(/^[0-9a-zA-Z_$]/)!==null){u=e.charAt(A);A++}else{u=null;O&&r("[0-9a-zA-Z_$]")}}if(o!==null)s=[s,o];else{s=null;A=i}}else{s=null;A=i}i=s!==null?s[0]+s[1].join(""):null;(O=n)&&i===null&&r("key");D[t]={nextPos:A,result:i};return i}function m(){var t="inline@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=O;O=!1;var i=A;if(e.substr(A,1)==='"'){var s='"';A+=1}else{s=null;O&&r('"\\""')}if(s!==null){if(e.substr(A,1)==='"'){var o='"';A+=1}else{o=null;O&&r('"\\""')}if(o!==null)s=[s,o];else{s=null;A=i}}else{s=null;A=i}i=s!==null?["literal",""]:null;if(i!==null)i=i;else{i=A;if(e.substr(A,1)==='"'){s='"';A+=1}else{s=null;O&&r('"\\""')}if(s!==null){o=y();if(o!==null){if(e.substr(A,1)==='"'){var u='"';A+=1}else{u=null;O&&r('"\\""')}if(u!==null)s=[s,o,u];else{s=null;A=i}}else{s=null;A=i}}else{s=null;A=i}i=s!==null?["literal",s[1]]:null;if(i!==null)i=i;else{i=A;if(e.substr(A,1)==='"'){s='"';A+=1}else{s=null;O&&r('"\\""')}if(s!==null){u=g();if(u!==null)for(o=[];u!==null;){o.push(u);u=g()}else o=null;if(o!==null){if(e.substr(A,1)==='"'){u='"';A+=1}else{u=null;O&&r('"\\""')}if(u!==null)s=[s,o,u];else{s=null;A=i}}else{s=null;A=i}}else{s=null;A=i}i=s!==null?["body"].concat(s[1]):null;i=i!==null?i:null}}(O=n)&&i===null&&r("inline");D[t]={nextPos:A,result:i};return i}function g(){var e="inline_part@"+A,t=D[e];if(t){A=t.nextPos;return t.result}t=h();if(t!==null)t=t;else{t=c();if(t!==null)t=t;else{t=y();t=t!==null?["buffer",t]:null;t=t!==null?t:null}}D[e]={nextPos:A,result:t};return t}function y(){var t="literal@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=O;O=!1;var i=A,s=A,o=O;O=!1;var u=E();O=o;if(u===null)o="";else{o=null;A=s}if(o!==null){u=A;s=O;O=!1;var a=T();O=s;if(a===null)s="";else{s=null;A=u}if(s!==null){u=b();if(u!==null)u=u;else{if(e.substr(A).match(/^[^"]/)!==null){u=e.charAt(A);A++}else{u=null;O&&r('[^"]')}u=u!==null?u:null}if(u!==null)o=[o,s,u];else{o=null;A=i}}else{o=null;A=i}}else{o=null;A=i}i=o!==null?o[2]:null;if(i!==null)for(var f=[];i!==null;){f.push(i);s=i=A;o=O;O=!1;u=E();O=o;if(u===null)o="";else{o=null;A=s}if(o!==null){u=A;s=O;O=!1;a=T();O=s;if(a===null)s="";else{s=null;A=u}if(s!==null){u=b();if(u!==null)u=u;else{if(e.substr(A).match(/^[^"]/)!==null){u=e.charAt(A);A++}else{u=null;O&&r('[^"]')}u=u!==null?u:null}if(u!==null)o=[o,s,u];else{o=null;A=i}}else{o=null;A=i}}else{o=null;A=i}i=o!==null?o[2]:null}else f=null;f=f!==null?f.join(""):null;(O=n)&&f===null&&r("literal");D[t]={nextPos:A,result:f};return f}function b(){var t="esc@"+A,n=D[t];if(n){A=n.nextPos;return n.result}if(e.substr(A,2)==='\\"'){n='\\"';A+=2}else{n=null;O&&r('"\\\\\\""')}n=n!==null?'"':null;D[t]={nextPos:A,result:n};return n}function w(){var t="comment@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=O;O=!1;var i=A;if(e.substr(A,2)==="{!"){var s="{!";A+=2}else{s=null;O&&r('"{!"')}if(s!==null){var o=[],u=A,a=A,f=O;O=!1;if(e.substr(A,2)==="!}"){var l="!}";A+=2}else{l=null;O&&r('"!}"')}O=f;if(l===null)f="";else{f=null;A=a}if(f!==null){if(e.length>A){a=e.charAt(A);A++}else{a=null;O&&r("any character")}if(a!==null)a=[f,a];else{a=null;A=u}}else{a=null;A=u}for(u=a!==null?a[1]:null;u!==null;){o.push(u);a=u=A;f=O;O=!1;if(e.substr(A,2)==="!}"){l="!}";A+=2}else{l=null;O&&r('"!}"')}O=f;if(l===null)f="";else{f=null;A=a}if(f!==null){if(e.length>A){a=e.charAt(A);A++}else{a=null;O&&r("any character")}if(a!==null)a=[f,a];else{a=null;A=u}}else{a=null;A=u}u=a!==null?a[1]:null}if(o!==null){if(e.substr(A,2)==="!}"){u="!}";A+=2}else{u=null;O&&r('"!}"')}if(u!==null)s=[s,o,u];else{s=null;A=i}}else{s=null;A=i}}else{s=null;A=i}i=s!==null?["comment",s[1].join("")]:null;(O=n)&&i===null&&r("comment");D[t]={nextPos:A,result:i};return i}function E(){var t="tag@"+A,n=D[t];if(n){A=n.nextPos;return n.result}n=A;var i=S();if(i!==null){if(e.substr(A).match(/^[#?^><+%:@\/~%]/)!==null){var s=e.charAt(A);A++}else{s=null;O&&r("[#?^><+%:@\\/~%]")}if(s!==null){var o=A,u=A,a=O;O=!1;var f=x();O=a;if(f===null)a="";else{a=null;A=u}if(a!==null){u=A;f=O;O=!1;var l=T();O=f;if(l===null)f="";else{f=null;A=u}if(f!==null){if(e.length>A){u=e.charAt(A);A++}else{u=null;O&&r("any character")}if(u!==null)a=[a,f,u];else{a=null;A=o}}else{a=null;A=o}}else{a=null;A=o}if(a!==null)for(var h=[];a!==null;){h.push(a);u=o=A;a=O;O=!1;f=x();O=a;if(f===null)a="";else{a=null;A=u}if(a!==null){u=A;f=O;O=!1;l=T();O=f;if(l===null)f="";else{f=null;A=u}if(f!==null){if(e.length>A){u=e.charAt(A);A++}else{u=null;O&&r("any character")}if(u!==null)a=[a,f,u];else{a=null;A=o}}else{a=null;A=o}}else{a=null;A=o}}else h=null;if(h!==null){o=x();if(o!==null)i=[i,s,h,o];else{i=null;A=n}}else{i=null;A=n}}else{i=null;A=n}}else{i=null;A=n}if(i!==null)n=i;else{n=c();n=n!==null?n:null}D[t]={nextPos:A,result:n};return n}function S(){var t="ld@"+A,n=D[t];if(n){A=n.nextPos;return n.result}if(e.substr(A,1)==="{"){n="{";A+=1}else{n=null;O&&r('"{"')}D[t]={nextPos:A,result:n};return n}function x(){var t="rd@"+A,n=D[t];if(n){A=n.nextPos;return n.result}if(e.substr(A,1)==="}"){n="}";A+=1}else{n=null;O&&r('"}"')}D[t]={nextPos:A,result:n};return n}function T(){var t="eol@"+A,n=D[t];if(n){A=n.nextPos;return n.result}if(e.substr(A,1)==="\n"){n="\n";A+=1}else{n=null;O&&r('"\\n"')}if(n!==null)n=n;else{if(e.substr(A,2)==="\r\n"){n="\r\n";A+=2}else{n=null;O&&r('"\\r\\n"')}if(n!==null)n=n;else{if(e.substr(A,1)==="\r"){n="\r";A+=1}else{n=null;O&&r('"\\r"')}if(n!==null)n=n;else{if(e.substr(A,1)==="\u2028"){n="\u2028";A+=1}else{n=null;O&&r('"\\u2028"')}if(n!==null)n=n;else{if(e.substr(A,1)==="\u2029"){n="\u2029";A+=1}else{n=null;O&&r('"\\u2029"')}n=n!==null?n:null}}}}D[t]={nextPos:A,result:n};return n}function N(){var t="ws@"+A,n=D[t];if(n){A=n.nextPos;return n.result}if(e.substr(A).match(/^[\t\u000b\u000c \xA0\uFEFF]/)!==null){n=e.charAt(A);A++}else{n=null;O&&r("[	\f \\xA0\\uFEFF]")}D[t]={nextPos:A,result:n};return n}function C(){var t=function(e){e.sort();for(var t=null,n=[],r=0;r<e.length;r++)if(e[r]!==t){n.push(e[r]);t=e[r]}switch(n.length){case 0:return"end of input";case 1:return n[0];default:return n.slice(0,n.length-1).join(", ")+" or "+n[n.length-1]}}(_),r=Math.max(A,M);r=r<e.length?n(e.charAt(r)):"end of input";return"Expected "+t+" but "+r+" found."}function k(){for(var t=1,n=1,r=!1,i=0;i<M;i++){var s=e.charAt(i);if(s==="\n"){r||t++;n=1;r=!1}else if(s==="\r"|s==="\u2028"||s==="\u2029"){t++;n=1;r=!0}else{n++;r=!1}}return{line:t,column:n}}function L(t,n){t.text=e.substring(n.split("@")[1],A);return t}var A=0,O=!0,M=0,_=[],D={},P=i();if(P===null||A!==e.length){P=k();throw new SyntaxError(C(),P.line,P.column)}return P},toSource:function(){return this._source}};e.SyntaxError=function(e,t,n){this.name="SyntaxError";this.message=e;this.line=t;this.column=n};e.SyntaxError.prototype=Error.prototype;return e}();e.parse=t.parse})(typeof exports!="undefined"?exports:window.dust);